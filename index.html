<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="./css/style.css">
    <title>Callback</title>
</head>
<body>
<!--callback_wrap не испольльзовать в продакшн-->
<div class="section_wrap">
    <section class="callback">
        <div class="callback_wrapper">
            <div class="callback-form_wrap">
                <div class="callback-form_container">
                    <h2 class="callback_title">
                        дышите чистым и полезным воздухом в вашем доме
                    </h2>
                    <hr class="line">
                    <p class="callback_subtitle">
                        Заполните форму для консультации специалиста
                    </p>
                    <form id="callback_form" class="callback_form">
                        <input type="text" class="callback_input" placeholder="Ваше имя">
                        <input id="callback_input-tel" type="tel" class="callback_input"
                               required="required"
                               pattern="\+7\s?[\(]{0,1}9[0-9]{2}[\)]{0,1}\s?\d{3}[-]{0,1}\d{2}[-]{0,1}\d{2}"
                               placeholder="Ваш телефон"> <!--value="+7(___)___-__-__"-->
                        <input type="email" class="callback_input" placeholder="Ваш e-Mail">
                        <input type="submit" class="callback_input" value="заказать звонок">
                    </form>
                </div>
            </div>
        </div>
    </section>
</div>
<script type="text/javascript">
    let setCursorPosition = (pos, e) => {
      //  e.focus();
        e.setSelectionRange(pos, pos);
    }
   let placeholder = "+7(___)___-__-__"
    function mask(e) {
        let matrix = placeholder,

            i = 0,
            def = matrix.replace(/\D/g, ""),
            val = this.value.replace(/\D/g, "");
        console.log(def, val)
        def.length >= val.length && (val = def);
        matrix = matrix.replace(/[_\d]/g, () => {
            return val.charAt(i++) || "_"
        });
        this.value = matrix;
        i = matrix.lastIndexOf(val.substr(-1));
        i < matrix.length && matrix !== placeholder ? i++ : i = matrix.indexOf("_");
      setCursorPosition(i, this)
    }

    window.addEventListener("DOMContentLoaded", () => {
        let input = document.querySelector("#callback_input-tel");
        input.addEventListener("input", mask, false);
        input.addEventListener('click', function () {
            if (this.value.charAt(3) === "_") {
                this.value = "+7(___)___-__-__"
                setCursorPosition(3, this);
            }
        })
        input.addEventListener('blur', function () {
            if (this.value.charAt(3) === "_") {
                this.value = "";
            }
        })
    });
</script>
</body>
</html>